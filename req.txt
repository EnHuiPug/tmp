
vi  /etc/resolv.conf
nameserver 114.114.114.114

wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo
vim /etc/yum.repos.d/CentOS-Base.repo
%s/$releasever/7/g
yum clean all
yum makecache
yum install centos-release-scl
yum install devtoolset-8-gcc*

mv /usr/bin/gcc /usr/bin/gcc-4.8.5
ln -s /opt/rh/devtoolset-8/root/bin/gcc /usr/bin/gcc
mv /usr/bin/g++ /usr/bin/g++-4.8.5
ln -s /opt/rh/devtoolset-8/root/bin/g++ /usr/bin/g++

sudo systemctl stop gdm.service
sudo systemctl status gdm.service
sudo systemctl start gdm.service

wget https://developer.download.nvidia.com/compute/cuda/11.7.0/local_installers/cuda_11.7.0_515.43.04_linux.run
sudo sh cuda_11.7.0_515.43.04_linux.run

export CUDA_HOME=/usr/local/cuda
export PATH=$CUDA_HOME/bin:$PATH
export LD_LIBRARY_PATH=$CUDA_HOME/lib64:$LD_LIBRARY_PATH


wget https://developer.download.nvidia.com/compute/cudnn/secure/8.9.2/local_installers/11.x/cudnn-linux-x86_64-8.9.2.26_cuda11-archive.tar.xz?_f5UPa8xCgeO9bepnkH95zBNN0GDrMuS3sl20rVQXU43WpRzOgjR--4JvEfRsAxC0OOhS9pp7M7qsWMXvSqyMtj3bE32ICMJWrKzjdqORkzmfmfWn_7IMNdtvbUr6muoZMNyhSH_BaTwfSFDpOInnKEAB2_zfE9dkFs
sudo cp cuda/include/cudnn*.h /usr/local/cuda/include/
sudo cp cuda/lib64/libcudnn* /usr/local/cuda/lib64/
sudo chmod a+r /usr/local/cuda/include/cudnn*.h
sudo chmod a+r /usr/local/cuda/lib64/libcudnn*

wget https://repo.anaconda.com/miniconda/Miniconda3-py310_23.5.2-0-Linux-x86_64.sh
sh Miniconda3-py310_23.5.2-0-Linux-x86_64.sh
conda create -n cpmbee python=3.10
pip install torch==1.13.1+cu117 torchvision==0.14.1+cu117 torchaudio==0.13.1 --extra-index-url https://download.pytorch.org/whl/cu117

pip install bmtrain -i https://pypi.tuna.tsinghua.edu.cn/simple/
pip install jieba tqdm tensorboard numpy spacy opendelta -i https://pypi.tuna.tsinghua.edu.cn/simple/



curl -s https://packagecloud.io/install/repositories/github/git-lfs/script.rpm.sh | sudo bash 
yum install git-lfs
git lfs install

git lfs clone https://huggingface.co/openbmb/cpm-bee-10b
git lfs pull --include="pytorch_model.bin"

